{% extends 'header.html' %}

{% block title %}SEAD AI{% endblock %}

{% block header %}SEAD AI{% endblock %}

{% block content %}

<div class="chat-container">
    <div id="chat-box">
        <div class="chat-message bot-message">
            <span class="message">Welcome to the SEAD AI assistant. How can I help you?</span>
        </div>
    </div>
    <input type="text" id="user-input" class="form-control" placeholder="Type your message...">
    <button id="send-btn">Send</button>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const chatBox = document.getElementById("chat-box");
        const userInput = document.getElementById("user-input");
        const sendBtn = document.getElementById("send-btn");

        // Function to add user message to the chat
        function addUserMessage(message) {
            const userMessage = document.createElement("div");
            userMessage.classList.add("chat-message", "user-message");
            userMessage.innerHTML = `<span class="message">${message}</span>`;
            chatBox.appendChild(userMessage);
        }

        // Function to add bot response to the chat
        function addBotMessage(message) {
            const botMessage = document.createElement("div");
            botMessage.classList.add("chat-message", "bot-message");
            botMessage.innerHTML = `<span class="message">${message}</span>`;
            chatBox.appendChild(botMessage);
        }

        // Function to handle user input
        function handleUserInput() {
            const message = userInput.value.trim();
            if (message !== "") {
                addUserMessage(message);
                userInput.value = "";

                // Send the user message to the server for processing
                fetch("/process_message", {
                    method: "POST",
                    body: JSON.stringify({ message: message }),
                    headers: {
                        "Content-Type": "application/json"
                    }
                })
                .then(response => response.json())
                .then(data => {
                    // Receive bot response from the server
                    addBotMessage(data.response);
                })
                .catch(error => {
                    console.error("Error:", error);
                });
            }
        }

        // Event listener for send button click
        sendBtn.addEventListener("click", handleUserInput);

        // Event listener for Enter key press
        userInput.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                handleUserInput();
            }
        });
    });
</script>

{% endblock %}
